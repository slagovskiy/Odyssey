{% extends 'oadmin/base.html' %}
{% load static %}

{% block oa-content %}
<script src="{% static 'libs/markup/markup.min.js' %}"></script>


{% verbatim %}
    <div id="dataTemplate" class="hide">
        <ul>{{.}}
            <li><a href="#dataForm" onclick="editData({{pk}});return false;" class="open-data-form">{{fields.name}} [{{fields.slug}}]</a></li>
        {{/.}}</ul>
    </div>
    <div id="dataEdit" class="hide">
        <form>{{.}}
            <div class="fields">
                <label for="txtSlug">slug</label>
                <input type="text" value="{{fields.slug}}" name="txtSlug" id="txtSlug">
                <br>
                <label for="txtName">name</label>
                <input type="text" value="{{fields.name}}" name="txtName" id="txtName">
            </div>
            <div class="action">
                <input type="button" value="save" class="btn btn-success">
            </div>
        {{/.}}</form>
    </div>
{% endverbatim %}
<div id="dataForm" class="dataForm"></div>
<div id="dataContainer" class="dataContainer"></div>

<script>
    function loadData()
    {
        $.ajax({
            url :'{% url 'oadmin_tag_all' %}',
            cashe: false
        }).done(function(data){
            var jdata = jQuery.parseJSON(data);
            var template = $('#dataTemplate').html();
            $('#dataContainer').html(Mark.up(template, jdata));
        });
    }

    function editData(key)
    {
        $.ajax({
            url :'{% url 'oadmin_tag' %}' + key + '/',
            cashe: false
        }).done(function(data){
            var jdata = jQuery.parseJSON(data);
            var template = $('#dataEdit').html();
            $('#dataForm').html(Mark.up(template, jdata));
        });

        $('.open-data-form').fancybox({
            padding: 0,
            type: 'inline',
            title: '',
            modal: false,
            autoSize: true
        });
    }

    $(document).ready(function(){
        loadData();
    });
</script>
{% endblock %}