{% extends 'admin/base.html' %}
{% load static %}

{% block content %}
    <script src="{% static 'libs/jsrender/jsrender.min.js' %}"></script>


    {% verbatim %}
    <script id="dataLinkTemplate" type="text/x-jsrender">
        <table class="data">
        <thead>
            <tr>
                <th>Name</td>
                <th>Link</td>
                <th>Slug</td>
            </tr>
        </thead>
        {{for items}}
            <tr class="{{if fields.deleted}}deleted {{/if}}{{if #getIndex()%2}}even{{/if}}">
                <td>
                    <a href="#dataLinkForm" onclick="editLinkData({{:pk}});return false;" class="open-data-form">{{cutstr max=70}}{{>fields.name}}{{/cutstr}}</a>
                </td>
                <td>{{cutstr max=50}}{{:fields.link}}{{/cutstr}}</td>
                <td>{{>fields.slug}}</td>
            </tr>
        {{/for}}
        </table>
    </script>
    <script id="dataLinkEdit" type="text/x-jsrender">
        <form id="editLinkForm">{{for items}}
            <div class="fields">
{% endverbatim %}
                {% csrf_token %}
{% verbatim %}
                <input type="hidden" value="{{:pk}}" name="id">
                <input type="hidden" value="{{:fields.deleted}}" name="deleted" id="deleted">
                <label for="txtSlug" class="col-md-2">slug</label>
                <textarea name="txtSlug" id="txtSlug" class="col-md-10 text">{{>fields.slug}}</textarea>
                <br>
                <label for="txtName" class="col-md-2">name</label>
                <textarea name="txtName" id="txtName" class="col-md-10 text">{{>fields.name}}</textarea>
                <br>
                <label for="txtLink" class="col-md-2">link</label>
                <textarea name="txtLink" id="txtLink" class="col-md-10 text">{{>fields.link}}</textarea>
                <br>
                <label for="txtOrder" class="col-md-2">link</label>
                <textarea name="txtOrder" id="txtOrder" class="col-md-10 text">{{>fields.order}}</textarea>
                <br>
                <input type="checkbox" name="blank" id="blank"{{if fields.blank}} checked{{/if}}><label for="blank" class="checkbox"> open link in new window</label>
                <br>
            </div>
            <div class="action">
                <button onclick="saveLinkData();" class="btn btn-success"><i class="fa fa-floppy-o"></i> save</button>
                {{if fields.deleted}}
                <button onclick="restoreLinkItem();" class="btn btn-info"><i class="fa fa-undo"></i> restore</button>
                {{else}}
                <button onclick="deleteLinkItem();" class="btn btn-danger"><i class="fa fa-times"></i> delete</button>
                {{/if}}
            </div>
        {{/for}}</form>
    </script>
{% endverbatim %}

<div class="admin-action">
    <a href="#dataLinkForm" onclick="editLinkData(-1);return false;" class="open-data-form"><i class="fa fa-plus"></i> add new folder</a>&nbsp;&nbsp;&nbsp;
    <a href="#" onclick="loadLinkData();return false;"><i class="fa fa-refresh"></i> refresh</a>
</div>
<div id="dataLinkForm" class="window" style="display: none;"></div>
<div id="dataLinkContainer" class="dataContainer"></div>

<script>
    $(document).ready(function(){
        url_mylink_get_all = '{% url 'admin_mylink_get' 0 %}';
        url_mylink_get = '{% url 'admin_mylink' %}';
        url_mylink_save = '{% url 'admin_mylink_save' %}';

        loadLinkData();
    });
</script>
{% endblock %}